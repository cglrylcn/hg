<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Havacılık Giriş Quiz</title>
    <style>
        :root {
            --primary: #0056b3;
            --secondary: #f0f4f8;
            --accent: #00a8ff;
            --text: #333;
            --success: #28a745;
            --error: #dc3545;
            --warning: #ffc107;
            --neutral: #e9ecef;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--secondary);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
        }

        .container {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 700px;
            position: relative;
            display: flex;
            flex-direction: column;
            max-height: 95vh;
        }

        /* Üst Bilgi Barı */
        .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            font-weight: bold;
            color: #666;
            font-size: 0.95rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        /* Toggle Switch (Anahtar) Tasarımı */
        .toggle-container {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.85rem;
            user-select: none;
        }

        .toggle-switch {
            position: relative;
            width: 40px;
            height: 20px;
            background-color: #ccc;
            border-radius: 20px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            background-color: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        input[type="checkbox"]:checked + .toggle-switch {
            background-color: var(--success);
        }

        input[type="checkbox"]:checked + .toggle-switch::after {
            transform: translateX(20px);
        }

        input[type="checkbox"] {
            display: none;
        }

        .quiz-content {
            overflow-y: auto;
            flex-grow: 1;
            padding-right: 5px;
        }

        .question-box {
            font-size: 1.1rem;
            margin-bottom: 1.2rem;
            line-height: 1.4;
            font-weight: 600;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
            text-align: left;
            width: 100%;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #f8f9fa;
            border-color: var(--primary);
        }

        .option-btn.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }

        .option-btn.wrong {
            background-color: var(--error);
            color: white;
            border-color: var(--error);
        }
        
        .option-btn:disabled {
            cursor: default;
            opacity: 0.9;
        }

        /* Navigation Buttons */
        .buttons-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            margin-bottom: 15px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            color: white;
            transition: opacity 0.2s;
        }

        .btn-next { background-color: var(--primary); }
        .btn-prev { background-color: #6c757d; }
        .btn-warning { background-color: #e0a800; color: #fff; }
        
        .btn:hover { opacity: 0.9; }
        .btn:disabled { background-color: #ccc; cursor: not-allowed; }

        /* Question Navigation Grid */
        .nav-grid-container {
            margin-top: auto;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        
        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(35px, 1fr));
            gap: 6px;
            max-height: 150px;
            overflow-y: auto;
        }

        .nav-item {
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--neutral);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: bold;
            color: #555;
            transition: transform 0.1s;
        }

        .nav-item:hover { transform: scale(1.05); }
        .nav-item.active { border: 2px solid var(--primary); box-sizing: border-box; }
        .nav-item.correct { background-color: var(--success); color: white; }
        .nav-item.wrong { background-color: var(--error); color: white; }

        /* Result Screen */
        #result-screen {
            text-align: center;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .score-circle {
            width: 140px;
            height: 140px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            box-shadow: 0 5px 15px rgba(0,86,179,0.3);
        }

        .score-number { font-size: 2.2rem; font-weight: bold; display: none; /* Puan gizlendi, sadece yüzde */ }
        .score-percent { font-size: 2rem; font-weight: bold; }
        .score-label { font-size: 0.9rem; opacity: 0.8; margin-top: 5px; }

        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }

    </style>
</head>
<body>

<div class="container" id="quiz-container">
    <div class="info-bar">
        <span id="question-count">Soru: 1/50</span>
        
        <label class="toggle-container">
            Doğruysa Otomatik Geç
            <input type="checkbox" id="auto-advance-toggle">
            <div class="toggle-switch"></div>
        </label>
    </div>

    <div class="quiz-content">
        <div class="question-box" id="question-text">
            Yükleniyor...
        </div>

        <div class="options" id="options-container">
            </div>
    </div>

    <div class="buttons-row">
        <button class="btn btn-prev" id="prev-btn" onclick="prevQuestion()">← Önceki</button>
        <button class="btn btn-next" id="next-btn" onclick="nextQuestion()">Sonraki →</button>
    </div>

    <div class="nav-grid-container">
        <div style="font-size: 0.8rem; color:#666; margin-bottom:5px; text-align:center;">Hızlı Erişim</div>
        <div class="nav-grid" id="nav-grid">
            </div>
    </div>
</div>

<div class="container" id="result-screen">
    <h1 id="result-title">Test Tamamlandı!</h1>
    <div class="score-circle">
        <span class="score-percent" id="final-percent">%0</span>
        <span class="score-label">BAŞARI</span>
    </div>
    <p id="result-message" style="font-size:1.1rem; margin-bottom: 20px;"></p>
    
    <div style="width: 100%; display: flex; flex-direction: column; gap: 10px;">
        <button class="btn btn-warning" id="retry-wrong-btn" onclick="startWrongQuiz()" style="display:none">Sadece Yanlışları Çöz</button>
        <button class="btn btn-next" onclick="startFullQuiz()">Tüm Testi Yeniden Başlat (Karışık)</button>
    </div>
</div>

<script>
    // Tüm soruların ana listesi
    const masterQuestions = [
        { q: "Havacılık faaliyetleri kaça ayrılır?", a: ["Üçe", "İkiye", "Dörde", "Beşe"], correct: 1 },
        { q: "Devlet hava araçları nelerdir?", a: ["Askerî, gümrük, polis", "Yolcu, kargo, eğitim", "Tarım, balon, planör", "Helikopter, jet, planör"], correct: 0 },
        { q: "Türkiye'nin tescil işareti nedir?", a: ["TR-XXX", "TK-XXX", "TC-XXX", "TL-XXX"], correct: 2 },
        { q: "Knot hangi büyüklüğü ölçer?", a: ["Yükseklik", "Basınç", "Hız", "Mesafe"], correct: 2 },
        { q: "1 foot kaç metredir?", a: ["0,25", "0,3048", "1,85", "3,048"], correct: 1 },
        { q: "Great Circle Distance neyi ifade eder?", a: ["İki pist arası farkı", "İki nokta arası en kısa mesafeyi", "Yatay rüzgâr mesafesini", "En uzun mesafeyi"], correct: 1 },
        { q: "Mach sayısı nasıl hesaplanır?", a: ["Aralık/hız", "Hız / Ses hızı", "Sıcaklık / Basınç", "Hız / Yükseklik"], correct: 1 },
        { q: "ICAO'nun tam açılımı nedir?", a: ["International Civil Aviation Organization", "International Cargo Air Organization", "Industrial Civil Air Operations", "International Control of Air Operations"], correct: 0 },
        { q: "ICAO'ya göre sivil havacılığın amacı nedir?", a: ["Askerî uçuşlar düzenlemek", "Hızlı ama pahalı ulaşım sağlamak", "Emniyetli, ekonomik, çevreye duyarlı ulaşım", "Uçak üretimini artırmak"], correct: 2 },
        { q: "Uçuşa elverişlilik ne anlama gelir?", a: ["Uçağın motor gücü yüksekse", "Uçağın emniyetli uçabilme şartlarını sağlaması", "Yük taşıma kapasitesinin fazla olması", "Eğitim uygunluğu"], correct: 1 },
        { q: "Tip Sertifikası nedir?", a: ["Uçuş planı", "Tasarım uygunluğu belgesi", "Yolcu kapasitesi raporu", "Lisans belgesi"], correct: 1 },
        { q: "SYK'nin açılımı nedir?", a: ["Sivil Yönetim Kurulu", "Sürekli Uçuşa Elverişlilik Yönetimi Kuruluşu", "Sistem Yetki Kurumu", "Saha Yetki Komisyonu"], correct: 1 },
        { q: "AMP nedir?", a: ["Aircraft Maintenance Plan", "Airport Management Program", "Aviation Main Policy", "Air Monitoring Plan"], correct: 0 },
        { q: "CRS belgesi neyi ifade eder?", a: ["Hava trafiği yoğunluğu", "Bakım sonrası uçağın uçuşa hazır olduğunu", "Uçuş planı değişikliğini", "Pilot yetki seviyesini"], correct: 1 },
        { q: "Hava tarafı hangi bölümü kapsar?", a: ["Terminal binası", "Pist, apron, taksi yolu", "Otopark", "Bagaj teslim alanı"], correct: 1 },
        { q: "ICAO Ek-14 neyi kapsar?", a: ["Havaalanı standartları", "Pilot lisansları", "Hava trafik yönetimi", "Bakım prosedürleri"], correct: 0 },
        { q: "ICAO Ek-17 hangi konudadır?", a: ["Meteoroloji", "Havaalanı güvenliği", "Arama kurtarma", "Hava trafik yönetimi"], correct: 1 },
        { q: "IATA kodu kaç harflidir?", a: ["2", "3", "4", "5"], correct: 1 },
        { q: "ICAO kodu kaç harflidir?", a: ["2", "3", "4", "5"], correct: 2 },
        { q: "Check-in işlemi neyi kapsar?", a: ["Güvenlik kontrolü", "Bagaj teslimi ve biniş kartı alma", "Uçağa binme", "Pasaport işlemi"], correct: 1 },
        { q: "ASK nedir?", a: ["Arz Edilen Koltuk-Km", "Arz Edilen Kargo-Km", "Ortalama Hız", "Aylık Sefer Kapasitesi"], correct: 0 },
        { q: "RPK nedir?", a: ["Arz Edilen Kargo-Km", "Ücretli Yolcu-Km", "Ortalama Sefer Uzunluğu", "Kargo Doluluk Oranı"], correct: 1 },
        { q: "Doluluk oranı nasıl hesaplanır?", a: ["ASK / RPK", "RPK / ASK", "ASK x RPK", "ASK + RPK"], correct: 1 },
        { q: "THAT hangi modeldir?", a: ["Düşük maliyetli taşıyıcı", "Tam hizmet ağ taşıyıcısı", "Özel sefer taşıyıcısı", "Bölgesel taşıyıcı"], correct: 1 },
        { q: "DMT hangi modeldir?", a: ["Düşük maliyetli taşıyıcı", "Tam hizmet ağ taşıyıcısı", "Bölgesel taşıyıcı", "Özel sefer"], correct: 0 },
        { q: "Charter uçuş nedir?", a: ["Tarifeli", "Tarifesiz özel uçuş", "Devlet uçuşu", "Eğitim uçuşu"], correct: 1 },
        { q: "Bölgesel taşıyıcılar hangi uçaklarla çalışır?", a: ["Geniş gövdeli jetler", "Küçük jet ve turboprop", "Savaş uçakları", "Planörler"], correct: 1 },
        { q: "Hibrit taşıyıcı nedir?", a: ["Charter + THAT", "THAT + DMT özelliklerini birleştirir", "DMT + BT birleşimi", "Kargo odaklıdır"], correct: 1 },
        { q: "CNS açılımı nedir?", a: ["Communication, Navigation, Surveillance", "Control, Navigation, System", "Civil Navigation Standards", "Cargo Network System"], correct: 0 },
        { q: "ILS sistemi ne işe yarar?", a: ["Yük taşımak", "Aletli iniş için yönlendirme", "Uçuş planı oluşturmak", "Hız ölçmek"], correct: 1 },
        { q: "VOR sistemi ne sağlar?", a: ["Yükseklik bilgisi", "Yön belirleme", "Hava durumu", "Mesafe ölçümü"], correct: 1 },
        { q: "DME ne ölçer?", a: ["Basınç", "Uzaklık", "Yön", "İrtifa"], correct: 1 },
        { q: "GNSS sistemi nedir?", a: ["Uydu tabanlı seyrüsefer sistemi", "Radar sistemi", "Hava tahmin aracı", "Uçuş planlama programı"], correct: 0 },
        { q: "SAR nedir?", a: ["Search and Rescue", "Safety and Regulation", "System Air Report", "Security Area Radar"], correct: 0 },
        { q: "ATM nedir?", a: ["Air Traffic Management", "Aviation Transport Market", "Aircraft Training Manual", "Air Terminal Maintenance"], correct: 0 },
        { q: "Meydan kontrolü hangi alanı yönetir?", a: ["Havalimanı çevresi", "Terminal binası", "Apron dışı bölge", "Pist dışı yollar"], correct: 0 },
        { q: "Yaklaşma kontrolü hangi aşamada çalışır?", a: ["Uçuş ortasında", "Kalkış ve iniş sırasında", "Bakım sürecinde", "Uçak parkında"], correct: 1 },
        { q: "Saha kontrolü hangi uçuşları yönetir?", a: ["Taksi uçuşları", "Seyir uçuşları", "Kısa mesafeli", "Charter seferleri"], correct: 1 },
        { q: "ICAO Annex 12 hangi konuyu kapsar?", a: ["Arama Kurtarma", "Güvenlik", "Meteoroloji", "Hava Trafik"], correct: 0 },
        { q: "ICAO Annex 16 neyle ilgilidir?", a: ["Gürültü ve emisyon", "Pilot lisansları", "Bakım kuralları", "Havaalanı işletmesi"], correct: 0 },
        { q: "EASA'nın görevi nedir?", a: ["Avrupa hava trafiğini düzenlemek", "AB ülkelerinde havacılık emniyeti ve sertifikasyonu sağlamak", "Uluslararası yolcu taşımak", "Pilot eğitimi vermek"], correct: 1 },
        { q: "EUROCONTROL'ün amacı nedir?", a: ["Hava kargo taşımacılığı", "Avrupa hava sahasının verimli yönetimi", "Eğitim planlaması", "Hava durumu ölçümü"], correct: 1 },
        { q: "ECAC ne yapar?", a: ["Uçak üretir", "Havacılık politikalarını uyumlaştırır", "Pilot lisansı verir", "Uçuş planları yazar"], correct: 1 },
        { q: "CORSIA ne anlama gelir?", a: ["Karbon denkleştirme ve azaltma sistemi", "Uçuş izin sistemi", "Kontrol alanı yönetimi", "Pilot sertifikasyonu"], correct: 0 },
        { q: "CBTA neyi ifade eder?", a: ["Competency-Based Training and Assessment", "Cargo-Based Transport Agreement", "Civil Business Training Area", "Communication-Based Traffic Agreement"], correct: 0 },
        { q: "Havacılıkta resmi haberleşme dili nedir?", a: ["Fransızca", "İngilizce", "Almanca", "Türkçe"], correct: 1 },
        { q: "Phraseology neden kullanılır?", a: ["Zaman kazanmak", "Yanlış anlamaları önlemek", "Eğitim süresini kısaltmak", "Şifreli iletişim sağlamak"], correct: 1 },
        { q: "Pilotlar için minimum İngilizce seviyesi nedir?", a: ["ICAO Level 2", "ICAO Level 3", "ICAO Level 4", "ICAO Level 5"], correct: 2 },
        { q: "LAPL ve ATPL farkı nedir?", a: ["LAPL en yüksek, ATPL en düşük", "LAPL hafif, ATPL havayolu pilot lisansıdır", "Aynıdır", "ATPL planör içindir"], correct: 1 },
        { q: "Havacılığın temel amacı nedir?", a: ["Hızlı ulaşım", "Emniyetli, sürdürülebilir, çevreye duyarlı ulaşım", "Turistik faaliyetleri artırmak", "Yakıt tüketimini artırmak"], correct: 1 }
    ];

    // Değişkenler
    let activeQuestions = []; // Şu anda çözülen soru seti
    let currentQuestionIndex = 0;
    let questionStatus = []; // 'correct', 'wrong', null
    let score = 0;

    // HTML Elemanları
    const questionText = document.getElementById("question-text");
    const optionsContainer = document.getElementById("options-container");
    const nextBtn = document.getElementById("next-btn");
    const prevBtn = document.getElementById("prev-btn");
    const questionCount = document.getElementById("question-count");
    const quizContainer = document.getElementById("quiz-container");
    const resultScreen = document.getElementById("result-screen");
    const navGrid = document.getElementById("nav-grid");
    const resultTitle = document.getElementById("result-title");
    const retryWrongBtn = document.getElementById("retry-wrong-btn");
    const autoAdvanceToggle = document.getElementById("auto-advance-toggle");

    // Yardımcı Fonksiyon: Karıştırma
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Navigasyon Gridini oluştur
    function renderGrid() {
        navGrid.innerHTML = "";
        activeQuestions.forEach((_, index) => {
            const item = document.createElement("div");
            item.className = "nav-item";
            item.textContent = index + 1;
            
            if (questionStatus[index] === 'correct') item.classList.add("correct");
            else if (questionStatus[index] === 'wrong') item.classList.add("wrong");
            
            if (index === currentQuestionIndex) item.classList.add("active");
            
            item.onclick = () => jumpToQuestion(index);
            navGrid.appendChild(item);
        });
    }

    function loadQuestion() {
        const currentQ = activeQuestions[currentQuestionIndex];
        
        questionText.textContent = `${currentQuestionIndex + 1}. ${currentQ.q}`;
        questionCount.textContent = `Soru: ${currentQuestionIndex + 1}/${activeQuestions.length}`;
        
        optionsContainer.innerHTML = "";
        const isAnswered = questionStatus[currentQuestionIndex] !== null;

        currentQ.a.forEach((option, index) => {
            const btn = document.createElement("button");
            btn.classList.add("option-btn");
            btn.textContent = option;
            
            if (isAnswered) {
                btn.disabled = true;
                if (index === currentQ.correct) {
                    btn.classList.add("correct");
                }
                // Yanlış cevaplanan butonu isterseniz burada işaretleyebilirsiniz
                // Şu an sadece doğruyu gösteriyoruz temiz görünüm için.
            } else {
                btn.onclick = () => checkAnswer(index, btn);
            }
            optionsContainer.appendChild(btn);
        });
        
        if (isAnswered) {
             const btns = optionsContainer.getElementsByClassName("option-btn");
             btns[currentQ.correct].classList.add("correct");
        }

        prevBtn.disabled = currentQuestionIndex === 0;
        
        if (currentQuestionIndex === activeQuestions.length - 1) {
            nextBtn.textContent = "Testi Bitir";
        } else {
            nextBtn.textContent = "Sonraki Soru →";
        }

        renderGrid();
    }

    function checkAnswer(selectedIndex, btn) {
        const currentQ = activeQuestions[currentQuestionIndex];
        const correctIndex = currentQ.correct;
        const buttons = optionsContainer.getElementsByClassName("option-btn");

        // Tüm butonları kilitle
        for (let button of buttons) {
            button.disabled = true;
        }

        if (selectedIndex === correctIndex) {
            // DOĞRU CEVAP
            btn.classList.add("correct");
            questionStatus[currentQuestionIndex] = 'correct';
            score++;
            
            // Otomatik geçiş kontrolü
            if (autoAdvanceToggle.checked) {
                // Kullanıcı yeşil rengi görsün diye hafif bir gecikme (1000ms = 1 saniye)
                setTimeout(() => {
                    nextQuestion();
                }, 1000);
            }

        } else {
            // YANLIŞ CEVAP
            btn.classList.add("wrong");
            buttons[correctIndex].classList.add("correct");
            questionStatus[currentQuestionIndex] = 'wrong';
            // Yanlış cevapta otomatik geçiş yapmıyoruz ki kullanıcı hatasını görsün.
        }

        renderGrid();
    }

    function nextQuestion() {
        if (currentQuestionIndex < activeQuestions.length - 1) {
            currentQuestionIndex++;
            loadQuestion();
        } else {
            showResult();
        }
    }

    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
        }
    }

    function jumpToQuestion(index) {
        currentQuestionIndex = index;
        loadQuestion();
    }

    function showResult() {
        quizContainer.style.display = "none";
        resultScreen.style.display = "flex";
        
        const finalPercentElem = document.getElementById("final-percent");
        const resultMessage = document.getElementById("result-message");

        const total = activeQuestions.length;
        const percent = Math.round((score / total) * 100);
        finalPercentElem.textContent = `%${percent}`;

        // Yanlış cevap var mı kontrol et
        const hasWrongAnswers = questionStatus.includes('wrong');
        
        if (hasWrongAnswers) {
            retryWrongBtn.style.display = "block";
            retryWrongBtn.textContent = `Sadece Yanlışları Çöz (${total - score} Soru)`;
        } else {
            retryWrongBtn.style.display = "none";
        }

        if (percent >= 90) {
            resultMessage.textContent = "Mükemmel! Konuya hakimsin.";
            resultMessage.style.color = "var(--success)";
        } else if (percent >= 70) {
            resultMessage.textContent = "Gayet iyi, tebrikler!";
            resultMessage.style.color = "var(--primary)";
        } else if (percent >= 50) {
            resultMessage.textContent = "Fena değil, ama tekrar yapmalısın.";
            resultMessage.style.color = "#d68910";
        } else {
            resultMessage.textContent = "Çalışmaya ihtiyacın var.";
            resultMessage.style.color = "var(--error)";
        }
    }

    function startFullQuiz() {
        activeQuestions = [...masterQuestions];
        shuffleArray(activeQuestions);
        resetQuizState();
        resultTitle.textContent = "Genel Tekrar Testi";
    }

    function startWrongQuiz() {
        const wrongQuestions = activeQuestions.filter((q, index) => questionStatus[index] === 'wrong');
        if(wrongQuestions.length === 0) {
            alert("Yanlış cevaplanmış soru bulunamadı.");
            return;
        }
        activeQuestions = wrongQuestions;
        shuffleArray(activeQuestions);
        resetQuizState();
        resultTitle.textContent = "Hata Düzeltme Modu";
    }

    function resetQuizState() {
        currentQuestionIndex = 0;
        score = 0;
        questionStatus = new Array(activeQuestions.length).fill(null);
        
        resultScreen.style.display = "none";
        quizContainer.style.display = "flex";
        
        loadQuestion();
    }

    // Başlangıç
    window.onload = startFullQuiz;

</script>

</body>
</html>