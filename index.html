<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Havacılık Quiz Pro - Tam Liste Görünüm</title>
    <style>
        :root {
            --primary: #0056b3;
            --secondary: #f4f6f9;
            --text: #333;
            --success: #28a745;
            --error: #dc3545;
            --neutral: #e9ecef;
            --warning: #ffc107;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--secondary);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center; /* Dikey ortalama */
            min-height: 100vh;
            margin: 0;
            padding: 20px 10px; /* Mobilde kenar boşluğu */
            box-sizing: border-box;
        }

        .container {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            width: 100%;
            max-width: 700px;
            display: flex;
            flex-direction: column;
            /* Yükseklik ayarları değiştirildi: İçeriğe göre uzasın */
            height: auto; 
            max-height: 95vh; /* Ekranın %95'ini geçmesin */
            overflow-y: auto; /* Eğer sığmazsa ana kutu scroll olsun */
        }

        /* Üst Bilgi */
        .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            flex-shrink: 0;
        }

        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.8rem;
            user-select: none;
        }

        .toggle-switch {
            position: relative;
            width: 36px;
            height: 18px;
            background-color: #ccc;
            border-radius: 20px;
            margin-left: 8px;
            transition: background-color 0.3s;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 14px;
            height: 14px;
            background-color: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        input[type="checkbox"]:checked + .toggle-switch { background-color: var(--success); }
        input[type="checkbox"]:checked + .toggle-switch::after { transform: translateX(18px); }
        input[type="checkbox"] { display: none; }

        /* Soru Alanı */
        .quiz-content {
            flex: 0 0 auto; /* Esnemesin, içeriği kadar yer kaplasın */
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }

        .question-box {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            line-height: 1.4;
            font-weight: 600;
            color: #222;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.15s;
            font-size: 0.95rem;
            text-align: left;
            width: 100%;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #f1f3f5;
            border-color: var(--primary);
        }

        .option-btn.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }

        .option-btn.wrong {
            background-color: var(--error);
            color: white;
            border-color: var(--error);
        }
        
        .option-btn:disabled { cursor: default; opacity: 0.9; }

        /* Alt Butonlar */
        .buttons-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            margin-bottom: 20px; /* Grid ile arasına biraz boşluk */
            flex-shrink: 0;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            transition: opacity 0.2s;
        }

        .btn-next { background-color: var(--primary); }
        .btn-prev { background-color: #6c757d; }
        .btn-warning { background-color: #ffc107; color: #333; }
        .btn:hover { opacity: 0.9; }
        .btn:disabled { background-color: #ccc; cursor: not-allowed; }

        /* Navigasyon Grid Container */
        .nav-grid-container {
            margin-top: 0; /* Artık auto değil, hemen butonların altında */
            border-top: 1px solid #eee;
            padding-top: 15px;
            flex-shrink: 0;
        }
        
        /* Gridin Kendisi */
        .nav-grid {
            display: grid;
            /* Kutucuklar ekran genişliğine göre sığabildiği kadar yan yana dizilsin */
            grid-template-columns: repeat(auto-fill, minmax(35px, 1fr)); 
            gap: 6px;
            /* Scroll KALDIRILDI, tümünü göster */
            max-height: none; 
            overflow-y: visible;
        }

        .nav-item {
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--neutral);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: bold;
            color: #555;
            transition: transform 0.1s;
        }

        .nav-item.active { border: 2px solid var(--primary); box-sizing: border-box; }
        .nav-item.correct { background-color: var(--success); color: white; }
        .nav-item.wrong { background-color: var(--error); color: white; }

        /* Sonuç Ekranı */
        #result-screen {
            text-align: center;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 20px 0;
        }

        .score-circle {
            width: 140px;
            height: 140px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .score-percent { font-size: 2.5rem; font-weight: bold; }
        .score-label { font-size: 0.9rem; opacity: 0.9; margin-top: 2px; }
        
        #result-message {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
        }

        /* Scrollbar Styling (Container için) */
        .container::-webkit-scrollbar { width: 8px; }
        .container::-webkit-scrollbar-track { background: #f1f1f1; }
        .container::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }

    </style>
</head>
<body>

<div class="container" id="quiz-container">
    <div class="info-bar">
        <span id="question-count">Soru: 1/82</span>
        <label class="toggle-container">
            Doğruysa Otomatik Geç
            <input type="checkbox" id="auto-advance-toggle">
            <div class="toggle-switch"></div>
        </label>
    </div>

    <div class="quiz-content">
        <div class="question-box" id="question-text">Yükleniyor...</div>
        <div class="options" id="options-container"></div>
    </div>

    <div class="buttons-row">
        <button class="btn btn-prev" id="prev-btn" onclick="prevQuestion()">← Önceki</button>
        <button class="btn btn-next" id="next-btn" onclick="nextQuestion()">Sonraki →</button>
    </div>

    <div class="nav-grid-container">
        <div style="font-size: 0.8rem; color:#888; margin-bottom:10px; text-align:center; font-weight:600;">Hızlı Erişim</div>
        <div class="nav-grid" id="nav-grid"></div>
    </div>
</div>

<div class="container" id="result-screen">
    <h1 id="result-title">Test Sonucu</h1>
    <div class="score-circle" id="score-circle-bg">
        <span class="score-percent" id="final-percent">%0</span>
        <span class="score-label">PUAN</span>
    </div>
    <div id="result-message"></div>
    
    <div style="width: 100%; display: flex; flex-direction: column; gap: 10px;">
        <button class="btn btn-warning" id="retry-wrong-btn" onclick="startWrongQuiz()" style="display:none">Sadece Yanlışları Çöz</button>
        <button class="btn btn-next" onclick="startFullQuiz()">Tüm Testi Yeniden Başlat (Karışık)</button>
    </div>
</div>

<script>
    const masterQuestions = [
        { q: "Havacılık faaliyetleri kaça ayrılır?", a: ["Üçe", "İkiye", "Dörde", "Beşe"], correct: 1 },
        { q: "Devlet hava araçları nelerdir?", a: ["Askerî, gümrük, polis", "Yolcu, kargo, eğitim", "Tarım, balon, planör", "Helikopter, jet, planör"], correct: 0 },
        { q: "Türkiye'nin tescil işareti nedir?", a: ["TR-XXX", "TK-XXX", "TC-XXX", "TL-XXX"], correct: 2 },
        { q: "Knot hangi büyüklüğü ölçer?", a: ["Yükseklik", "Basınç", "Hız", "Mesafe"], correct: 2 },
        { q: "1 foot kaç metredir?", a: ["0,25", "0,3048", "1,85", "3,048"], correct: 1 },
        { q: "Great Circle Distance neyi ifade eder?", a: ["İki pist arası farkı", "İki nokta arası en kısa mesafeyi", "Yatay rüzgâr mesafesini", "En uzun mesafeyi"], correct: 1 },
        { q: "Mach sayısı nasıl hesaplanır?", a: ["Aralık/hız", "Hız / Ses hızı", "Sıcaklık / Basınç", "Hız / Yükseklik"], correct: 1 },
        { q: "ICAO'nun tam açılımı nedir?", a: ["International Civil Aviation Organization", "International Cargo Air Organization", "Industrial Civil Air Operations", "International Control of Air Operations"], correct: 0 },
        { q: "ICAO'ya göre sivil havacılığın amacı nedir?", a: ["Askerî uçuşlar düzenlemek", "Hızlı ama pahalı ulaşım sağlamak", "Emniyetli, ekonomik, çevreye duyarlı ulaşım", "Uçak üretimini artırmak"], correct: 2 },
        { q: "Uçuşa elverişlilik ne anlama gelir?", a: ["Uçağın motor gücü yüksekse", "Uçağın emniyetli uçabilme şartlarını sağlaması", "Yük taşıma kapasitesinin fazla olması", "Eğitim uygunluğu"], correct: 1 },
        { q: "Tip Sertifikası nedir?", a: ["Uçuş planı", "Tasarım uygunluğu belgesi", "Yolcu kapasitesi raporu", "Lisans belgesi"], correct: 1 },
        { q: "SYK'nin açılımı nedir?", a: ["Sivil Yönetim Kurulu", "Sürekli Uçuşa Elverişlilik Yönetimi Kuruluşu", "Sistem Yetki Kurumu", "Saha Yetki Komisyonu"], correct: 1 },
        { q: "AMP nedir?", a: ["Aircraft Maintenance Plan", "Airport Management Program", "Aviation Main Policy", "Air Monitoring Plan"], correct: 0 },
        { q: "CRS belgesi neyi ifade eder?", a: ["Hava trafiği yoğunluğu", "Bakım sonrası uçağın uçuşa hazır olduğunu", "Uçuş planı değişikliğini", "Pilot yetki seviyesini"], correct: 1 },
        { q: "Hava tarafı hangi bölümü kapsar?", a: ["Terminal binası", "Pist, apron, taksi yolu", "Otopark", "Bagaj teslim alanı"], correct: 1 },
        { q: "ICAO Ek-14 neyi kapsar?", a: ["Havaalanı standartları", "Pilot lisansları", "Hava trafik yönetimi", "Bakım prosedürleri"], correct: 0 },
        { q: "ICAO Ek-17 hangi konudadır?", a: ["Meteoroloji", "Havaalanı güvenliği", "Arama kurtarma", "Hava trafik yönetimi"], correct: 1 },
        { q: "IATA kodu kaç harflidir?", a: ["2", "3", "4", "5"], correct: 1 },
        { q: "ICAO kodu kaç harflidir?", a: ["2", "3", "4", "5"], correct: 2 },
        { q: "Check-in işlemi neyi kapsar?", a: ["Güvenlik kontrolü", "Bagaj teslimi ve biniş kartı alma", "Uçağa binme", "Pasaport işlemi"], correct: 1 },
        { q: "ASK nedir?", a: ["Arz Edilen Koltuk-Km", "Arz Edilen Kargo-Km", "Ortalama Hız", "Aylık Sefer Kapasitesi"], correct: 0 },
        { q: "RPK nedir?", a: ["Arz Edilen Kargo-Km", "Ücretli Yolcu-Km", "Ortalama Sefer Uzunluğu", "Kargo Doluluk Oranı"], correct: 1 },
        { q: "Doluluk oranı nasıl hesaplanır?", a: ["ASK / RPK", "RPK / ASK", "ASK x RPK", "ASK + RPK"], correct: 1 },
        { q: "THAT hangi modeldir?", a: ["Düşük maliyetli taşıyıcı", "Tam hizmet ağ taşıyıcısı", "Özel sefer taşıyıcısı", "Bölgesel taşıyıcı"], correct: 1 },
        { q: "DMT hangi modeldir?", a: ["Düşük maliyetli taşıyıcı", "Tam hizmet ağ taşıyıcısı", "Bölgesel taşıyıcı", "Özel sefer"], correct: 0 },
        { q: "Charter uçuş nedir?", a: ["Tarifeli", "Tarifesiz özel uçuş", "Devlet uçuşu", "Eğitim uçuşu"], correct: 1 },
        { q: "Bölgesel taşıyıcılar hangi uçaklarla çalışır?", a: ["Geniş gövdeli jetler", "Küçük jet ve turboprop", "Savaş uçakları", "Planörler"], correct: 1 },
        { q: "Hibrit taşıyıcı nedir?", a: ["Charter + THAT", "THAT + DMT özelliklerini birleştirir", "DMT + BT birleşimi", "Kargo odaklıdır"], correct: 1 },
        { q: "CNS açılımı nedir?", a: ["Communication, Navigation, Surveillance", "Control, Navigation, System", "Civil Navigation Standards", "Cargo Network System"], correct: 0 },
        { q: "ILS sistemi ne işe yarar?", a: ["Yük taşımak", "Aletli iniş için yönlendirme", "Uçuş planı oluşturmak", "Hız ölçmek"], correct: 1 },
        { q: "VOR sistemi ne sağlar?", a: ["Yükseklik bilgisi", "Yön belirleme", "Hava durumu", "Mesafe ölçümü"], correct: 1 },
        { q: "DME ne ölçer?", a: ["Basınç", "Uzaklık", "Yön", "İrtifa"], correct: 1 },
        { q: "GNSS sistemi nedir?", a: ["Uydu tabanlı seyrüsefer sistemi", "Radar sistemi", "Hava tahmin aracı", "Uçuş planlama programı"], correct: 0 },
        { q: "SAR nedir?", a: ["Search and Rescue", "Safety and Regulation", "System Air Report", "Security Area Radar"], correct: 0 },
        { q: "ATM nedir?", a: ["Air Traffic Management", "Aviation Transport Market", "Aircraft Training Manual", "Air Terminal Maintenance"], correct: 0 },
        { q: "Meydan kontrolü hangi alanı yönetir?", a: ["Havalimanı çevresi", "Terminal binası", "Apron dışı bölge", "Pist dışı yollar"], correct: 0 },
        { q: "Yaklaşma kontrolü hangi aşamada çalışır?", a: ["Uçuş ortasında", "Kalkış ve iniş sırasında", "Bakım sürecinde", "Uçak parkında"], correct: 1 },
        { q: "Saha kontrolü hangi uçuşları yönetir?", a: ["Taksi uçuşları", "Seyir uçuşları", "Kısa mesafeli", "Charter seferleri"], correct: 1 },
        { q: "ICAO Annex 12 hangi konuyu kapsar?", a: ["Arama Kurtarma", "Güvenlik", "Meteoroloji", "Hava Trafik"], correct: 0 },
        { q: "ICAO Annex 16 neyle ilgilidir?", a: ["Gürültü ve emisyon", "Pilot lisansları", "Bakım kuralları", "Havaalanı işletmesi"], correct: 0 },
        { q: "EASA'nın görevi nedir?", a: ["Avrupa hava trafiğini düzenlemek", "AB ülkelerinde havacılık emniyeti ve sertifikasyonu sağlamak", "Uluslararası yolcu taşımak", "Pilot eğitimi vermek"], correct: 1 },
        { q: "EUROCONTROL'ün amacı nedir?", a: ["Hava kargo taşımacılığı", "Avrupa hava sahasının verimli yönetimi", "Eğitim planlaması", "Hava durumu ölçümü"], correct: 1 },
        { q: "ECAC ne yapar?", a: ["Uçak üretir", "Havacılık politikalarını uyumlaştırır", "Pilot lisansı verir", "Uçuş planları yazar"], correct: 1 },
        { q: "CORSIA ne anlama gelir?", a: ["Karbon denkleştirme ve azaltma sistemi", "Uçuş izin sistemi", "Kontrol alanı yönetimi", "Pilot sertifikasyonu"], correct: 0 },
        { q: "CBTA neyi ifade eder?", a: ["Competency-Based Training and Assessment", "Cargo-Based Transport Agreement", "Civil Business Training Area", "Communication-Based Traffic Agreement"], correct: 0 },
        { q: "Havacılıkta resmi haberleşme dili nedir?", a: ["Fransızca", "İngilizce", "Almanca", "Türkçe"], correct: 1 },
        { q: "Phraseology neden kullanılır?", a: ["Zaman kazanmak", "Yanlış anlamaları önlemek", "Eğitim süresini kısaltmak", "Şifreli iletişim sağlamak"], correct: 1 },
        { q: "Pilotlar için minimum İngilizce seviyesi nedir?", a: ["ICAO Level 2", "ICAO Level 3", "ICAO Level 4", "ICAO Level 5"], correct: 2 },
        { q: "LAPL ve ATPL farkı nedir?", a: ["LAPL en yüksek, ATPL en düşük", "LAPL hafif, ATPL havayolu pilot lisansıdır", "Aynıdır", "ATPL planör içindir"], correct: 1 },
        { q: "Havacılığın temel amacı nedir?", a: ["Hızlı ulaşım", "Emniyetli, sürdürülebilir, çevreye duyarlı ulaşım", "Turistik faaliyetleri artırmak", "Yakıt tüketimini artırmak"], correct: 1 },
        { q: "ICAO Kodlarına göre ülkemizdeki havaalanları hangi harf ile başlamaktadır?", a: ["T", "L", "E", "K"], correct: 1 },
        { q: "Havadan hafif hava araçları nelerdir?", a: ["Helikopter ve Planör", "Uçak ve Jet", "Balon ve Zeplin", "İHA ve SİHA"], correct: 2 },
        { q: "Bakımın yapıldığı yere göre bakım türleri hangileridir?", a: ["A ve C Bakımı", "Önleyici ve Düzenleyici", "Hat Bakımı ve Üs Bakımı", "Periyodik ve Arıza"], correct: 2 },
        { q: "Bakım personelinin lisans kategorileri hangisinde doğru verilmiştir?", a: ["A, B1, B2, C", "P1, P2, P3", "L1, L2, L3", "Tekniker, Mühendis, Usta"], correct: 0 },
        { q: "İber-Amerika Konferansı'nın diğer adı nedir?", a: ["Paris Antlaşması", "Varşova Konvansiyonu", "Madrid Antlaşması", "Şikago Sözleşmesi"], correct: 2 },
        { q: "Hava Taksi işletmeciliği için maksimum koltuk sayısı kaçtır?", a: ["9", "14", "19", "25"], correct: 2 },
        { q: "Havayolu İşletmeciliği tescil belgesinde aşağıdakilerden hangisi yer ALMAZ?", a: ["İşleticinin adı", "Kullanılacak uçak tipleri", "Uçak Sigorta Bedeli", "İzin verilen operasyonlar"], correct: 2 },
        { q: "Hava Trafik Kontrolörünün değiştirebileceği uçuş parametreleri nelerdir?", a: ["Motor gücü, Yakıt miktarı", "Uçuş başı, Hız, İrtifa", "Yolcu sayısı, Kargo yükü", "Kalkış saati, İniş takımı"], correct: 1 },
        { q: "Aşağıdakilerden hangisi Hava Trafik Kontrol Hizmetlerinden (ATC) biridir?", a: ["Meydan Kontrol", "Arama Kurtarma", "Gümrük Kontrol", "Bilet Kontrol"], correct: 0 },
        { q: "Aşağıdakilerden hangisi Uluslararası Sivil Havacılık kuruluşlarından DEĞİLDİR?", a: ["EASA", "IATA", "EUROCONTROL", "ENAC"], correct: 3 },
        { q: "Bir uçağın kalkış için hareket etmesinden, inip park etmesine kadar geçen süreye ne denir?", a: ["Uçuş Saati", "Mesai Saati", "Blok Saat", "Sefer Süresi"], correct: 2 },
        { q: "Yolcunun uçağa binişine kadar verilen hizmete ne ad verilir?", a: ["Boarding", "Check-In", "Handling", "Catering"], correct: 1 },
        { q: "Uçağın Tip Yetkisini (Type Certificate) neresi verir?", a: ["Tescil Eden Ülke", "Üretildiği Ülke", "İşletildiği Ülke", "Pilotun Ülkesi"], correct: 1 },
        { q: "Sürekli Uçuşa Elverişlilik Sertifikasını kim verir?", a: ["Üretici Firma", "Üretildiği Ülke", "Hava aracını Tescil Eden Ülke", "EASA"], correct: 2 },
        { q: "Havacılık personeli lisanslarında 'BPL' neyi ifade eder?", a: ["Balon Pilot Lisansı", "Büyük Pilot Lisansı", "Bölgesel Pilot Lisansı", "Başlangıç Pilot Lisansı"], correct: 0 },
        { q: "Uyarı hizmetleri (Alerting Service) kimlere verilir?", a: ["Sadece askeri uçaklara", "Sadece yolcu uçaklarına", "Hava trafik hizmeti sağlanan ve uçuş planı dolduran tüm uçaklara", "Sadece acil durum bildiren uçaklara"], correct: 2 },
        { q: "Paris Antlaşması'nın tam adı nedir?", a: ["Uluslararası Sivil Havacılık Anlaşması", "Hava Seyrüseferinin Düzenlenmesine Dair Anlaşma", "Hava Yolu Taşıma Sözleşmesi", "Avrupa Hava Sahası Anlaşması"], correct: 1 },
        { q: "Yapılış amacına göre bakım türleri nelerdir?", a: ["Hat ve Üs", "Ağır ve Hafif", "Önleyici ve Düzenleyici", "Yaz ve Kış"], correct: 2 },
        { q: "Aşağıdakilerden hangisi bir havacılık sözleşmesi DEĞİLDİR?", a: ["Pekin", "Paris", "Madrid", "Şikago"], correct: 0 },
        { q: "Aşağıdakilerden hangisi havaalanlarındaki 'Havacılık Dışı Hizmetler'den biridir?", a: ["Yer hizmetleri", "Yakıt ikmali", "Eğlence ve Bankacılık hizmetleri", "Uçak bakımı"], correct: 2 },
        { q: "Programlı bakım için gerekli dokümanlardan 'MEL'in açılımı nedir?", a: ["Maximum Equipment List", "Minimum Equipment List (Asgari Teçhizat Listesi)", "Maintenance Equipment Log", "Main Engine List"], correct: 1 },
        { q: "Yetkinlik Bazlı Eğitim (CBTA) neye dayalı değerlendirme yapar?", a: ["Ezbere", "Yazılı sınava", "Performansa", "Ders saatine"], correct: 2 },
        { q: "EASA'nın görevlerinden olmayan hangisidir?", a: ["Havacılık emniyetini geliştirmek", "Üye devletlerin LEHİNE karar vermek", "Sertifikasyon yapmak", "Eğitim ve denetim yapmak"], correct: 1 },
        { q: "Uçuş devam ederken (seferler arası) yapılan bakım türü genellikle hangisidir?", a: ["Üs Bakımı", "Ağır Bakım", "Hat Bakımı", "Depo Bakımı"], correct: 2 },
        { q: "Havacılık telsiz frekans aralığı nedir?", a: ["88.0 - 108.0 MHz", "118.000 - 137.000 MHz", "400 - 500 MHz", "2.4 - 5 GHz"], correct: 1 },
        { q: "ATSEP personelinin görevi nedir?", a: ["Uçak kullanmak", "Bilet kesmek", "CNS (Haberleşme, Seyrüsefer, Gözetim) sistemlerinin bakımını yapmak", "Bagaj taşımak"], correct: 2 },
        { q: "Uçuş Harekat Uzmanının (Dispatcher) görevi nedir?", a: ["Uçağı tamir etmek", "Uçuş planlaması yapmak ve uçuşu izlemek", "Yolculara servis yapmak", "Hava trafik kontrolü yapmak"], correct: 1 },
        { q: "Döner kanatlı hava araçlarında (helikopter) kullanılan motor tipi nedir?", a: ["Pistonlu", "Turbofan", "Turboşaft", "Elektrikli"], correct: 2 },
        { q: "ICAO Annex 1 hangi konuyu kapsar?", a: ["Havaalanları", "Personel Lisanslandırma", "Güvenlik", "Hava Kuralları"], correct: 1 },
        { q: "1 NM (Deniz Mili) kaç metredir?", a: ["1000", "1609", "1852", "2000"], correct: 2 },
        { q: "Hangisi IATA'nın görevlerinden biridir?", a: ["Hava sahasını yönetmek", "Lisans vermek", "Havayolu endüstrisini temsil etmek ve liderlik etmek", "Uçak üretmek"], correct: 2 },
        { q: "Hava Akış Yönetimi (Network Flow) uçuştan kaç gün önce başlar?", a: ["1 gün", "3 gün", "6 gün", "1 ay"], correct: 2 },
        { q: "Döner kanatlı hava aracı hangisidir?", a: ["Planör", "Zeplin", "Gyroplane / Helikopter", "Jet"], correct: 2 }
    ];

    let activeQuestions = [];
    let currentQuestionIndex = 0;
    let questionStatus = [];
    let score = 0;

    const questionText = document.getElementById("question-text");
    const optionsContainer = document.getElementById("options-container");
    const nextBtn = document.getElementById("next-btn");
    const prevBtn = document.getElementById("prev-btn");
    const questionCount = document.getElementById("question-count");
    const quizContainer = document.getElementById("quiz-container");
    const resultScreen = document.getElementById("result-screen");
    const navGrid = document.getElementById("nav-grid");
    const resultTitle = document.getElementById("result-title");
    const retryWrongBtn = document.getElementById("retry-wrong-btn");
    const autoAdvanceToggle = document.getElementById("auto-advance-toggle");
    const scoreCircleBg = document.getElementById("score-circle-bg");

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function renderGrid() {
        navGrid.innerHTML = "";
        activeQuestions.forEach((_, index) => {
            const item = document.createElement("div");
            item.className = "nav-item";
            item.textContent = index + 1;
            
            if (questionStatus[index] === 'correct') item.classList.add("correct");
            else if (questionStatus[index] === 'wrong') item.classList.add("wrong");
            if (index === currentQuestionIndex) item.classList.add("active");
            
            item.onclick = () => jumpToQuestion(index);
            navGrid.appendChild(item);
        });
    }

    function loadQuestion() {
        const currentQ = activeQuestions[currentQuestionIndex];
        questionText.textContent = `${currentQuestionIndex + 1}. ${currentQ.q}`;
        questionCount.textContent = `Soru: ${currentQuestionIndex + 1}/${activeQuestions.length}`;
        optionsContainer.innerHTML = "";
        
        const isAnswered = questionStatus[currentQuestionIndex] !== null;

        currentQ.a.forEach((option, index) => {
            const btn = document.createElement("button");
            btn.classList.add("option-btn");
            btn.textContent = option;
            
            if (isAnswered) {
                btn.disabled = true;
                if (index === currentQ.correct) btn.classList.add("correct");
            } else {
                btn.onclick = () => checkAnswer(index, btn);
            }
            optionsContainer.appendChild(btn);
        });
        
        if (isAnswered) {
             const btns = optionsContainer.getElementsByClassName("option-btn");
             btns[currentQ.correct].classList.add("correct");
        }

        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.textContent = currentQuestionIndex === activeQuestions.length - 1 ? "Testi Bitir" : "Sonraki Soru →";
        renderGrid();
    }

    function checkAnswer(selectedIndex, btn) {
        const currentQ = activeQuestions[currentQuestionIndex];
        const correctIndex = currentQ.correct;
        const buttons = optionsContainer.getElementsByClassName("option-btn");

        for (let button of buttons) button.disabled = true;

        if (selectedIndex === correctIndex) {
            btn.classList.add("correct");
            questionStatus[currentQuestionIndex] = 'correct';
            score++;
            if (autoAdvanceToggle.checked) setTimeout(nextQuestion, 800);
        } else {
            btn.classList.add("wrong");
            buttons[correctIndex].classList.add("correct");
            questionStatus[currentQuestionIndex] = 'wrong';
        }
        renderGrid();
    }

    function nextQuestion() {
        if (currentQuestionIndex < activeQuestions.length - 1) {
            currentQuestionIndex++;
            loadQuestion();
        } else {
            showResult();
        }
    }

    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
        }
    }

    function jumpToQuestion(index) {
        currentQuestionIndex = index;
        loadQuestion();
    }

    function showResult() {
        quizContainer.style.display = "none";
        resultScreen.style.display = "flex";
        
        const finalPercentElem = document.getElementById("final-percent");
        const resultMessage = document.getElementById("result-message");

        const total = activeQuestions.length;
        const percent = total === 0 ? 0 : Math.round((score / total) * 100);
        finalPercentElem.textContent = `%${percent}`;

        const hasWrongAnswers = questionStatus.includes('wrong');
        retryWrongBtn.style.display = hasWrongAnswers ? "block" : "none";
        if(hasWrongAnswers) retryWrongBtn.textContent = `Sadece Yanlışları Çöz (${total - score} Soru)`;

        if (percent >= 70) {
            resultMessage.textContent = "BAŞARILI";
            resultMessage.style.color = "var(--success)";
            resultMessage.style.backgroundColor = "#d4edda";
            resultMessage.style.border = "1px solid #c3e6cb";
            scoreCircleBg.style.background = "var(--success)";
        } else {
            resultMessage.textContent = "BAŞARISIZ";
            resultMessage.style.color = "var(--error)";
            resultMessage.style.backgroundColor = "#f8d7da";
            resultMessage.style.border = "1px solid #f5c6cb";
            scoreCircleBg.style.background = "var(--error)";
        }
    }

    function startFullQuiz() {
        activeQuestions = [...masterQuestions];
        shuffleArray(activeQuestions);
        resetQuizState();
        resultTitle.textContent = "Genel Tekrar Testi";
    }

    function startWrongQuiz() {
        const wrongQuestions = activeQuestions.filter((q, index) => questionStatus[index] === 'wrong');
        activeQuestions = wrongQuestions;
        shuffleArray(activeQuestions);
        resetQuizState();
        resultTitle.textContent = "Hata Düzeltme Modu";
    }

    function resetQuizState() {
        currentQuestionIndex = 0;
        score = 0;
        questionStatus = new Array(activeQuestions.length).fill(null);
        resultScreen.style.display = "none";
        quizContainer.style.display = "flex";
        loadQuestion();
    }

    window.onload = startFullQuiz;

</script>

</body>
</html>